<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>IOS 스크롤 관련</title>
  <style>
  *{
    margin: 0; padding: 0;
  }
  html,body{
    width: 100%;
    height: 100%;
  }
  #nav{
    transition: all 0.3s ease;
    width: 80% ;height: 100%;
    display: inline-block;
    position: fixed;
    left: -80%;
    opacity: 0.9;
    background-color: #1ff;
    
    z-index: 10;
    overflow-y: scroll;
    overflow-x : hidden;
    -webkit-overflow-scrolling : touch;
  }
  #btn{
    position: fixed;
    z-index: 10;
    padding: 10px;
    right: 0;
    background-color: #fff;
  }
  #nav.open{
    left: 0;
  }
  section div{
    height: 500px;
  }
  .t1{
    background-color: #d3d3d3;
  }
  .t2{
    background-color: #999;
  } 
  #section{
    width: 100%;
    height: 100vh;
    position: fixed;
    overflow-y: scroll;
    -webkit-overflow-scrolling : touch;
  }
  #section.lock{
    overflow-y: hidden;
    -webkit-overflow-scrolling : unset;
  }

  #nav span{
    width: 100%; height: 150px;
    display: inline-block;
    background-color: #d3d;
    border: 1px solid #000;
  }

  #nav span:nth-child(2n){
    background-color: #3d3;
  }
  #dimd{
    width: 100%;
    height: 100%;
    display: inline-block;
    background-color: #ff1;
    position: absolute;
    opacity: 0.4;
    z-index: 1;
    display: none;
  }
  #dimd.on{
    display: block;
  }

  </style>
</head>

<body>
  <div id="nav">
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
  </div>
  <button id="btn">nav button</button>
  <div id="dimd"></div>
  <section id="section">
    <div class="t1"></div>
    <div class="t2"></div>
    <div class="t1"></div>
    <div class="t2"></div>
    <div class="t1"></div>
    <div class="t2"></div>
  </section>
</body>

<script>
function eventHandler(el, eventNames,listener, type) {
  var events = eventNames.split(' ');
  if(typeof type == 'undefined'){type = true};
  if(type){
    el.thisTypeEventListener = window.addEventListener;
  }else{
    el.thisTypeEventListener = window.removeEventListener;
  };
  for (var i = 0; i < events.length; i++) {
    el.thisTypeEventListener(events[i], listener, false);
  };
};
function preventEvent(e) {
  e.preventDefault();
  e.stopPropagation();
}

function toggleClass(el,classname, condition){
  if(typeof condition == 'undefined'){condition = el.classList.contains(classname)}
  if(condition){
    el.classList.remove(classname);
  }else{
    el.classList.add(classname);
  };
};

var ScrollTest = function(){
  doc = document.scrollingElement;
  var nav = document.getElementById('nav'),
      btn = document.getElementById('btn'),
      dimd = document.getElementById('dimd'),
      section = document.getElementById('section')
  ;
  var v = (function (){
    var state = false, nowSt = 0;
    return {
      state : (function(){
        return {
          get : function(){return state},
          not : function(){state = !state},
          set : function(f){f(state)},
        }
      })(),
      nowSt : (function(){
        return {
          get : function(){return nowSt},
          now : function(){nowSt = doc.scrollTop},
          set : function(f){f(nowSt)},
        }
      })(), 
      clickType : (function(){
        var filter = "win16|win32|win64|mac", type;
        if (navigator.platform ) {
          if(filter.indexOf(navigator.platform.toLowerCase()) < 0) {
            return 'touchstart';
          } else {
            return 'click';
          }
        }
      })(),
      navUnderValue : nav.scrollHeight - nav.offsetHeight ,
    };//return
  })();// v;

  // console.log(v);

  function fixedScroll(e){
    doc.scrollTop = v.nowSt.get();
    preventEvent(e);
  };

  function navCorrection(){
    var navSt = this.scrollTop;
    if(navSt <= 0){
      this.scrollTop = 1;
    }else if(navSt >= v.navUnderValue){
      this.scrollTop = v.navUnderValue - 1;
    };
  };

  function scrollOnOff(b){
    if(b){v.nowSt.now()};
    eventHandler(section, 'scroll mousewheel', fixedScroll, b);
  };

  function btnClick(){
    v.state.not();
    toggleClass(nav,'open');
    toggleClass(dimd,'on');
    toggleClass(section ,'lock');
    scrollOnOff(v.state.get());
  };

  function dimdClick(){
    if(!(v.state.get())){return};
    btnClick();
  };
 
  function eventHandling(){
    eventHandler(dimd, v.clickType, dimdClick);
    eventHandler(btn, 'click', btnClick);
    eventHandler(nav, 'scroll', navCorrection);
  }; 

  eventHandling();
}// ScrollTest;
eventHandler(document, 'DOMContentLoaded', ScrollTest);
</script>

</html>